<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Healthcare Exploratory Data Project using SQL</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-interactiveBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="0d53a788-4175-4a6f-b52c-c4338fc577eb" class="page serif"><header><h1 class="page-title">Healthcare Exploratory Data Project using SQL</h1><p class="page-description"></p></header><div class="page-body"><p id="7b14eec4-564b-4def-9c6f-01ac6df8bff7" class="">
</p><p id="e2488387-e99c-472e-b56d-fc45ba281b8b" class="">In this project I used the programming language SQL to complete an exploratory data analysis of hospital patients created by Synthea. <a href="https://synthetichealth.github.io/synthea/">Synthea</a> is an open-source, synthetic patient generator that models the medical history of synthetic patients.</p><p id="9c8aab6d-1560-45f3-aed3-ce19d733994e" class="">Performing the analyzation will allow me to discover patterns, spot anomalies, find outliers, answer questions &amp; assumptions, test hypotheses, and find interesting relationships between the variables. Since the data is generated, there was very little manipulating and cleaning to do. Despite knowing the data would be fairly clean I still explored and read through the data with queries viewing all the columns in each table.</p><p id="3c2af7bb-4a3b-434f-90b6-c7474035b843" class="">
</p><p id="9607919d-f5d6-44b0-8a16-d6d200b81d10" class="">First I downloaded individual CSV files from Synthea to obtain the <code>Patients</code>, <code>Immunizations</code>, and <code>Encounters</code> tables. I then created the Synthea Healthcare dataset in BigQuery and imported the tables into it. 
</p><figure id="3751bfe6-3260-4d12-9e04-b6abead6b5c7" class="image"><a href="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled.png"><img style="width:295px" src="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled.png"/></a></figure><p id="836149ee-8a8d-4b80-a985-2a69795c1b04" class="">I had a set of questions regarding the dataset &amp; I knew what data I was looking to retrieve. The requirements were to find active hospital patients older than 6 months old, who received the flu shot once in the year 2021.</p><p id="16d296cc-ee99-4132-bd54-01be9d0c8a87" class="">Other questions requested in order to build out a dashboard with the data were:
</p><ol type="1" id="4905532b-9d6f-434e-91e6-c2e1156efd00" class="numbered-list" start="1"><li>Total % of patients getting flu shots</li></ol><p id="48c69276-a74d-4227-b820-c515790fa822" class="">       by Age, Race, Gender, County, and the Overall number</p><ol type="1" id="5d699d67-95e9-4d70-a146-c966c1accd88" class="numbered-list" start="2"><li>Running total of flu shots over the course of 2021</li></ol><ol type="1" id="73b93bb3-59a8-4df3-b26e-789fe1326cb6" class="numbered-list" start="3"><li>Total number of flu shots given in 2021</li></ol><ol type="1" id="0f40378c-0f80-45a3-b0cb-9cfc0c5ff11c" class="numbered-list" start="4"><li>List of patients who did or did not receive the flu shot</li></ol><ol type="1" id="d552e936-dfbe-45fa-95a5-e6e553b46d02" class="numbered-list" start="5"><li>Demographics (age, race, gender) of patients who did not receive the flu shot</li></ol><p id="ca9f3da5-3ba7-4253-9680-cedf943c6c66" class="">
</p><p id="f230d8e8-e4a6-493b-bcb8-c803541c64aa" class="">I then proceeded to query the tables in order to see what types of data was stored inside and where the tables will join by primary and foreign keys:</p><p id="2b5fb946-f10f-46c0-8fde-3106f8a07fe3" class="">
</p><pre id="1b27cc37-feaa-409e-a04e-ff61ee695584" class="code"><code>SELECT *
FROM `healthcareeda-396011.SyntheaHealthcare.patients`

--To view the columns in the Patient table 
-- and see if there&#x27;s birthdate or age, race, county

SELECT pat.birthdate, pat.race, pat.county, pat.gender, pat.id, pat.first, pat.last
FROM `healthcareeda-396011.SyntheaHealthcare.patients` as pat

--These are the columns I was able to extract the patient data from</code></pre><p id="ee79f214-d0a5-427e-8c36-93fcf681ca2e" class="">
</p><figure id="99813c35-99b3-4ae1-82d2-ddc32908abb7" class="image"><a href="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%201.png"><img style="width:1555px" src="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%201.png"/></a></figure><p id="f3de2c4d-2980-45e5-a64e-91b7348b78d8" class="">
</p><figure id="927030c5-b3e0-43b1-a74b-2d014fa1a56c" class="image"><a href="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%202.png"><img style="width:1553px" src="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%202.png"/></a></figure><p id="6fb3579e-f3a0-4e79-b280-cf9244436f5c" class="">
</p><p id="58bcd762-073d-40b2-84dd-01082adba674" class="">I noticed in both the First and Last name columns  3 numbers followed each entry, so I cleaned the two columns by using the <strong>SUBSTR</strong> function:</p><p id="7059afce-3dd8-4ec6-9ab8-fb4d5da4a8cb" class="">
</p><pre id="9d2090a0-506a-4698-a07a-0ceff436ca96" class="code"><code>SELECT pat.birthdate, pat.race, pat.county, pat.gender, pat.id, 
SUBSTR(pat.first, 1,length(pat.first)-3) as first, 
SUBSTR(pat.last, 1,length(pat.last)-3) as last
FROM `healthcareeda-396011.SyntheaHealthcare.patients` as pat</code></pre><p id="3b348712-0fe6-4158-8913-b36487a6a072" class="">
</p><p id="543cbaa9-b419-4d1d-a95b-cf079e21d511" class="">Here I view into the <code>Immunizations</code> table:</p><p id="79251d37-c44b-4232-9d46-bbd3ae9c29fa" class="">
</p><pre id="a6f212d6-e0c2-4c32-a03f-8bf9cfaaf3dd" class="code"><code>SELECT *
FROM immunizations

SELECT *
FROM `healthcareeda-396011.SyntheaHealthcare.immunizations`
WHERE code = 140
  AND date BETWEEN &#x27;2021-01-01 00:00:00&#x27; AND &#x27;2021-12-31 23:59:00&#x27;

--description column contains flu vaccination details, each description 
-- has it&#x27;s own code, flu is 140. </code></pre><p id="094ff8f9-c454-4329-858b-1f189fb54c63" class="">
</p><figure id="400c63e7-4633-4020-9410-79c10f6fe623" class="image"><a href="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%203.png"><img style="width:1551px" src="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%203.png"/></a></figure><p id="4ac6ddd4-3e4e-4819-bbad-f09cae868878" class="">
</p><pre id="4c3000ac-b8d9-46e8-b370-0507762671be" class="code"><code>erDiagram
    IMMUNIZATIONS ||--|{ PATIENTS : recieve
    IMMUNIZATIONS {
        string patient PK, FK
        int code
        string description
				timestamp date
				string encounter
    }
    ENCOUNTERS ||--|{ PATIENTS : have
    ENCOUNTERS {
				string id PK
        string patient FK 
        timestamp start
				timestamp stop
    }
    PATIENTS {
        string id PK
        date birthdate
				date deathdate
				string race
				string county
				string first
				string last
    }
</code></pre><p id="fa93ad81-e469-4c62-87b2-204ef41691e2" class="">
</p><p id="ec050f5c-5a5d-4bb3-88cf-71c05e147424" class="">Knowing I would need to join the tables in order to answer the question, a one to one  join was created to see patients and the earliest time they received a flu shot, without repeating rows. I also made a <strong>CTE</strong> which would be a temporary holding place to store the drilled down <code>Immunizations</code> table and <code>Encounters</code> table later in my query:
</p><pre id="6a795815-0f2b-4ec5-ac5b-89a82f134b92" class="code"><code>--The CTE made to hold the drilled down Immunization table result, 
--filtering the year and flu vaccination 

WITH flu_shot_2021 AS
(
SELECT patient, MIN(DATE) AS earliest_flu_shot_2021
FROM `healthcareeda-396011.SyntheaHealthcare.immunizations`
WHERE code = 140
  AND date BETWEEN &#x27;2021-01-01 00:00:00&#x27; AND &#x27;2021-12-31 23:59:00&#x27;
GROUP BY patient
)

SELECT pat.birthdate, pat.race, pat.county, pat.id, 
SUBSTR(pat.first, 1,length(pat.first)-3) as first, 
SUBSTR(pat.last, 1,length(pat.last)-3) as last
FROM `healthcareeda-396011.SyntheaHealthcare.patients` as pat
left join flu_shot_2021 as flu
	on pat.id = flu.patient

--*Left Join used to recieve all the patient despite having their vaccinations or not</code></pre><p id="a7b5b395-706b-4ec0-a3a4-5d8264469bae" class="">
</p><figure id="036da290-1b3d-4dd7-b203-59f83be504a3" class="image"><a href="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%204.png"><img style="width:1554px" src="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%204.png"/></a></figure><p id="a74cea8d-1ef6-46cd-a19c-f2e23656d4bd" class="">
</p><p id="59ba56fc-cdb4-44cb-85b0-c21d1af09604" class="">A <strong>CASE</strong> statement was used to obtain a binary field in the <code>Patients</code> table  in order to add  the number of patients with flu shots and to create percentages easily.</p><p id="8f4d19ef-935f-4724-aaa1-88f56edb0a83" class="">
</p><pre id="4419ffd6-0536-4e2d-97cc-1d9e49b9e7ea" class="code"><code>WITH flu_shot_2021 AS
(
SELECT patient, MIN(DATE) AS earliest_flu_shot_2021
FROM `healthcareeda-396011.SyntheaHealthcare.immunizations`
WHERE code = 140
  AND date BETWEEN &#x27;2021-01-01 00:00:00&#x27; AND &#x27;2021-12-31 23:59:00&#x27;
GROUP BY patient
)

SELECT pat.birthdate, pat.race, pat.county, pat.gender, pat.id, 
SUBSTR(pat.first, 1,length(pat.first)-3) as first, 
SUBSTR(pat.last, 1,length(pat.last)-3) as last,
flu.earliest_flu_shot_2021, --To see the results from the joined Immunization table --
  case when flu.patient is not null then 1
  else 0
  end as flu_shot_2021
FROM `healthcareeda-396011.SyntheaHealthcare.patients` as pat
LEFT JOIN flu_shot_2021 as flu
	ON pat.id = flu.patient</code></pre><p id="65448bdb-73c5-4012-a12e-4f944d15a8dc" class="">
</p><figure id="74a8946c-f10e-4f66-9c99-88328c39b404" class="image"><a href="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%205.png"><img style="width:1554px" src="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%205.png"/></a></figure><p id="e0444e02-3eca-4b0a-b3a9-1558496f1c97" class="">
</p><p id="4709e501-a139-4be0-bfa1-8e6004b2103f" class="">An additional CTE was added to the query in order to narrow down the results and remove patients that have died or moved in the last few years. This information was stored within the <code>Encounters</code> table.
The patients filtered by the <code>Encounters</code> table CTE are called in the last <strong>WHERE</strong> statement as <code>patient</code> in <code>active_patients</code>
</p><pre id="5b0c36a7-afdf-4dab-8306-2c9102ddad97" class="code"><code>WITH flu_shot_2021 as
(
SELECT patient, min(date) as earliest_flu_shot_2021
FROM `healthcareeda-396011.SyntheaHealthcare.immunizations`
WHERE code = 140
  AND date BETWEEN &#x27;2021-01-01 00:00:00&#x27; AND &#x27;2021-12-31 23:59:00&#x27;
GROUP BY patient
),

active_patients as
(
SELECT patient, DATE_DIFF(&#x27;2021-12-31&#x27;, pat.birthdate, MONTH) AS age_in_months
FROM `healthcareeda-396011.SyntheaHealthcare.encounters` as e
JOIN `healthcareeda-396011.SyntheaHealthcare.patients` as pat
	on e.patient = pat.id
WHERE start BETWEEN &#x27;2019-01-01 00:00:00&#x27; and &#x27;2021-12-31 23:59:00&#x27;
	and pat.deathdate is null
	and DATE_DIFF(&#x27;2021-12-31&#x27;, pat.birthdate,MONTH) &gt;= 6
)

SELECT pat.birthdate, pat.race, pat.county, pat.gender, pat.id, 
SUBSTR(pat.first, 1,length(pat.first)-3) as first, 
SUBSTR(pat.last, 1,length(pat.last)-3) as last,
flu.earliest_flu_shot_2021, 
  case when flu.patient is not null then 1
  else 0
  end as flu_shot_2021
FROM `healthcareeda-396011.SyntheaHealthcare.patients` as pat
left join flu_shot_2021 as flu
	on pat.id = flu.patient
where 1=1
	and pat.id in(SELECT patient FROM active_patients) </code></pre><p id="7a793580-bc0a-464a-bed6-d2603ab0cb44" class="">
</p><figure id="18929c91-d081-4634-88c9-f9f608aa88f9" class="image"><a href="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%206.png"><img style="width:1555px" src="Healthcare%20Exploratory%20Data%20Project%20using%20SQL%200d53a78841754a6fb52cc4338fc577eb/Untitled%206.png"/></a></figure><p id="4d78d2d5-6a3b-4dde-8798-ebfcd8be5a82" class="">The end query brings our results down to 995 from the initial 1163 .</p><h3 id="7214156d-afce-473e-8078-aaa0df48e4dc" class="">Summary</h3><p id="17c1a5ff-bcad-476b-b0b8-099ae1d9d6f3" class=""> Through exploring the datasets and reading what values they held I was able to create queries that will result in visual charts to produce easily accessible data. This project allowed me to utilize SQL and learn how different statements such as CTEâ€™s, CASE, SUBSTR, and LEFT JOIN can lead to successful and insightful data analyzing. Finding the variables that are required for statistics is key to delivering what stakeholders and a general audience can see within data.</p><p id="4160d7f4-337a-4232-9610-19c6695824cf" class="">
</p></div></article></body></html>